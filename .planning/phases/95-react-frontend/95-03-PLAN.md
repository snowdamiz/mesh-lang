---
phase: 95-react-frontend
plan: 03
type: execute
wave: 2
depends_on: ["95-01"]
files_modified:
  - frontend/src/pages/issues.tsx
  - frontend/src/pages/events.tsx
  - frontend/src/components/shared/filter-bar.tsx
  - frontend/src/components/shared/data-table.tsx
  - frontend/src/components/shared/pagination.tsx
autonomous: true

must_haves:
  truths:
    - "Issues page displays a TanStack Table with columns: title, level, status, event count, last seen"
    - "Events page displays a TanStack Table with columns: message, level, issue ID, received at"
    - "Both pages have a filter bar with level, environment, and search text inputs"
    - "Both pages support keyset pagination with Next/Previous buttons"
    - "Clicking an issue or event row opens the push panel detail view"
  artifacts:
    - path: "frontend/src/pages/issues.tsx"
      provides: "Issues list page with TanStack Table, filters, pagination"
    - path: "frontend/src/pages/events.tsx"
      provides: "Events search page with TanStack Table, filters, pagination"
    - path: "frontend/src/components/shared/filter-bar.tsx"
      provides: "Reusable filter bar component (search, level, environment)"
    - path: "frontend/src/components/shared/data-table.tsx"
      provides: "Generic TanStack Table wrapper with shadcn styling"
    - path: "frontend/src/components/shared/pagination.tsx"
      provides: "Keyset pagination controls"
  key_links:
    - from: "frontend/src/pages/issues.tsx"
      to: "frontend/src/lib/api.ts"
      via: "api.issues.list call"
      pattern: "api\\.issues\\.list"
    - from: "frontend/src/pages/events.tsx"
      to: "frontend/src/lib/api.ts"
      via: "api.events.search call"
      pattern: "api\\.events\\.search"
    - from: "frontend/src/components/shared/data-table.tsx"
      to: "@tanstack/react-table"
      via: "useReactTable hook"
      pattern: "useReactTable"
---

<objective>
Build the Issues page (UI-02, UI-03) and Events page (UI-02) with TanStack Table for data display, reusable filter bar, and keyset pagination. Both pages follow the same pattern: filter bar at top, data table in the middle, pagination at the bottom. Clicking a row opens the push panel for detail view (detail content built in Plan 04).

Purpose: Issues and Events are the core data browsing pages. They share the same table/filter/pagination patterns, so building them together maximizes code reuse with the shared data-table and filter-bar components.
Output: Two functional list pages with filtering, sorting, and pagination.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/95-react-frontend/95-RESEARCH.md
@.planning/phases/95-react-frontend/95-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create shared data table, filter bar, and pagination components</name>
  <files>
    frontend/src/components/shared/data-table.tsx
    frontend/src/components/shared/filter-bar.tsx
    frontend/src/components/shared/pagination.tsx
  </files>
  <action>
    **Data Table (`data-table.tsx`):**
    Generic TanStack Table wrapper component with shadcn styling. Follow the shadcn data-table recipe.
    - Props: `{ columns: ColumnDef<T>[], data: T[], onRowClick?: (row: T) => void, isLoading?: boolean }`
    - Uses `useReactTable` with `getCoreRowModel` and `getSortingRowModel`
    - Renders shadcn `<Table>` with `<TableHeader>`, `<TableBody>`, `<TableRow>`, `<TableCell>`
    - Row hover state: `hover:bg-accent cursor-pointer` when onRowClick provided
    - When `isLoading` is true, render 5 skeleton rows (Skeleton components matching column widths)
    - When data is empty and not loading, show "No results found" centered message
    - Sortable columns: click header to toggle ascending/descending, show sort indicator icon (ChevronUp/ChevronDown from lucide-react)
    - Dense row height for Linear-style density: `h-10` rows with compact padding

    **Filter Bar (`filter-bar.tsx`):**
    Reusable horizontal filter bar used by Issues, Events, and Live Stream pages.
    - Props: `{ onFilterChange: (filters: FilterState) => void, showSearch?: boolean, showStatus?: boolean, showLevel?: boolean, showEnvironment?: boolean }`
    - FilterState: `{ search?: string, status?: string, level?: string, environment?: string }`
    - Layout: horizontal row with items spaced evenly, wrapping on small screens
    - Search input: shadcn Input with Search icon (lucide-react), debounced 300ms
    - Level select: shadcn Select with options: All, Error, Warning, Info, Debug
    - Status select: shadcn Select with options: All, Unresolved, Resolved, Archived
    - Environment select: shadcn Input (free-text, since environments are dynamic)
    - Compact styling, subtle borders, monochrome

    **Pagination (`pagination.tsx`):**
    Keyset pagination controls matching the backend's cursor-based pagination.
    - Props: `{ hasMore: boolean, onNext: () => void, onPrevious: () => void, hasPrevious: boolean }`
    - Layout: "Previous" and "Next" buttons (shadcn Button variant="outline") aligned right
    - Buttons disabled when no more data in that direction
    - Uses cursor stack pattern: maintain a stack of previous cursors in the parent component to enable "Previous" navigation with keyset pagination
    - Show "Showing results" text between buttons (no exact count since keyset pagination doesn't provide total)
  </action>
  <verify>
    Run `cd frontend && npx tsc --noEmit` to verify all shared components compile.
  </verify>
  <done>
    Generic DataTable renders TanStack Table with shadcn styling, sorting, loading skeletons, and empty state. FilterBar provides debounced search, level/status/environment selects. Pagination provides cursor-based Previous/Next controls with disabled states.
  </done>
</task>

<task type="auto">
  <name>Task 2: Build Issues and Events list pages with filters and pagination</name>
  <files>
    frontend/src/pages/issues.tsx
    frontend/src/pages/events.tsx
  </files>
  <action>
    **Issues Page (`issues.tsx`):**
    Full issues list page with filter bar, data table, and pagination.

    Column definitions (ColumnDef<Issue>[]):
    - Title: `accessorKey: 'title'`, cell renders truncated text (max-w-[400px]) with `font-medium`
    - Level: `accessorKey: 'level'`, cell renders StatusBadge component
    - Status: `accessorKey: 'status'`, cell renders status badge (unresolved/resolved/archived)
    - Events: `accessorKey: 'event_count'`, cell renders formatted number with `tabular-nums text-muted-foreground`
    - Last Seen: `accessorKey: 'last_seen'`, cell renders relative time with `text-muted-foreground`

    Data fetching:
    - State: `{ issues: Issue[], loading: boolean, hasMore: boolean, cursor: string | null, cursorId: string | null, cursorStack: Array<{cursor, cursorId}> }`
    - Fetch on mount and when filters change: `api.issues.list(activeProjectId, { status, level, cursor, cursor_id, limit: 25 })`
    - Reset cursor and cursorStack when filters change
    - On "Next": push current cursor to stack, fetch with next_cursor/next_cursor_id
    - On "Previous": pop cursor from stack, fetch with popped cursor

    Filter bar: show search (filters by title -- client-side or backend if supported), status filter (defaults to 'unresolved' per decision [89-02]), level filter.

    Row click: `uiStore.openDetail({ type: 'issue', id: issue.id })` to trigger push panel.

    Page layout:
    ```
    <PushPanelLayout panel={detailPanel}>
      <div className="flex flex-col h-full">
        <div className="p-6 pb-0">
          <h1 className="text-2xl font-semibold tracking-tight">Issues</h1>
          <FilterBar ... />
        </div>
        <div className="flex-1 p-6 pt-4 overflow-auto">
          <DataTable columns={issueColumns} data={issues} onRowClick={...} isLoading={loading} />
        </div>
        <div className="p-6 pt-0">
          <Pagination ... />
        </div>
      </div>
    </PushPanelLayout>
    ```

    **Events Page (`events.tsx`):**
    Full events search page with filter bar, data table, and pagination.

    Column definitions (ColumnDef<EventSummary>[]):
    - Message: `accessorKey: 'message'`, cell renders truncated text (max-w-[500px])
    - Level: `accessorKey: 'level'`, cell renders StatusBadge
    - Issue: `accessorKey: 'issue_id'`, cell renders truncated ID with `font-mono text-xs text-muted-foreground`
    - Received: `accessorKey: 'received_at'`, cell renders relative time

    Data fetching:
    - When search query is present: use `api.events.search(projectId, { q: searchQuery, limit: 25 })`
    - When tag filter is present: use `api.events.byTag(projectId, { key, value, limit: 25 })`
    - Otherwise show empty state with "Search events by message, tags, or other criteria" prompt
    - Note: events search endpoint doesn't support keyset pagination (returns flat array), so pagination only for tag search or show limited results

    Filter bar: show search (full-text), level filter, environment filter.

    Row click: `uiStore.openDetail({ type: 'event', id: event.id })`.

    Same page layout pattern as Issues page but wrapped in PushPanelLayout.
  </action>
  <verify>
    Run `cd frontend && npx tsc --noEmit` to verify both page components compile.
    Run `cd frontend && npm run build` to verify production build succeeds.
  </verify>
  <done>
    Issues page renders TanStack Table with title/level/status/count/last-seen columns, filter bar with status/level filters, and keyset pagination. Events page renders TanStack Table with message/level/issue/received columns, search/level/environment filters. Both pages trigger push panel on row click. Default status filter is 'unresolved' for issues. Loading skeletons and empty states handled.
  </done>
</task>

</tasks>

<verification>
1. `cd frontend && npx tsc --noEmit` passes
2. `cd frontend && npm run build` succeeds
3. Issues page at `/issues` shows table with columns and filter bar
4. Events page at `/events` shows search input and table
5. Both pages show loading skeletons during fetch
6. Both pages show empty state when no data
7. Filter changes trigger data refetch with reset pagination
</verification>

<success_criteria>
- Issues page with TanStack Table (5 columns), status/level filters, keyset pagination
- Events page with TanStack Table (4 columns), full-text search, level/environment filters
- Shared DataTable component with sorting, loading states, and row click handler
- Shared FilterBar component reusable across Issues, Events, and Live Stream
- Shared Pagination component with cursor stack for bidirectional navigation
- PushPanelLayout integration for detail views (panel content in Plan 04)
- Default 'unresolved' status filter on Issues page
</success_criteria>

<output>
After completion, create `.planning/phases/95-react-frontend/95-03-SUMMARY.md`
</output>
