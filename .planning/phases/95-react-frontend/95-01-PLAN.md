---
phase: 95-react-frontend
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/package.json
  - frontend/vite.config.ts
  - frontend/tsconfig.json
  - frontend/tsconfig.app.json
  - frontend/index.html
  - frontend/components.json
  - frontend/src/main.tsx
  - frontend/src/app.tsx
  - frontend/src/globals.css
  - frontend/src/lib/utils.ts
  - frontend/src/lib/api.ts
  - frontend/src/hooks/use-websocket.ts
  - frontend/src/hooks/use-theme.ts
  - frontend/src/stores/project-store.ts
  - frontend/src/stores/ws-store.ts
  - frontend/src/stores/ui-store.ts
  - frontend/src/types/api.ts
  - frontend/src/components/layout/app-sidebar.tsx
  - frontend/src/components/layout/header.tsx
  - frontend/src/components/layout/push-panel.tsx
  - frontend/src/components/ui/*
autonomous: true

must_haves:
  truths:
    - "Vite dev server starts and renders the app shell with sidebar, header, and content area"
    - "Six navigation items in sidebar route to placeholder pages (Dashboard, Issues, Events, Live Stream, Alerts, Settings)"
    - "Theme toggle switches between dark and light mode with consistent monochrome palette"
    - "WebSocket connection status dot appears in the header (red when disconnected)"
    - "API client can fetch from /api proxied to localhost:8080"
  artifacts:
    - path: "frontend/package.json"
      provides: "Project dependencies (React 19, Vite, Tailwind v4, shadcn, Recharts, TanStack Table, Zustand, React Router)"
    - path: "frontend/src/app.tsx"
      provides: "Root layout with sidebar, header, content area, and router outlet"
    - path: "frontend/src/globals.css"
      provides: "Tailwind v4 import with oklch CSS variables matching Mesh landing page theme"
    - path: "frontend/src/lib/api.ts"
      provides: "Typed fetch wrapper for all REST API endpoints"
    - path: "frontend/src/hooks/use-websocket.ts"
      provides: "WebSocket hook with exponential backoff reconnection"
    - path: "frontend/src/stores/ws-store.ts"
      provides: "Zustand store for WebSocket state and message dispatch"
    - path: "frontend/src/types/api.ts"
      provides: "TypeScript types matching all backend JSON response shapes"
  key_links:
    - from: "frontend/src/app.tsx"
      to: "frontend/src/components/layout/app-sidebar.tsx"
      via: "React component import"
      pattern: "import.*AppSidebar"
    - from: "frontend/src/lib/api.ts"
      to: "/api/v1"
      via: "fetch with Vite proxy"
      pattern: "fetch.*API_BASE"
    - from: "frontend/src/hooks/use-websocket.ts"
      to: "frontend/src/stores/ws-store.ts"
      via: "Zustand store integration"
      pattern: "useWsStore"
---

<objective>
Scaffold the complete React 19 SPA project with Vite, Tailwind v4, shadcn/ui, and build the application shell: persistent left sidebar with project list and navigation, header with WebSocket status indicator and theme toggle, content area with React Router routing to all 6 pages. Establish all shared infrastructure: typed API client, WebSocket hook with reconnection, Zustand stores, TypeScript types, and the monochrome theme matching the Mesh landing page.

Purpose: This is the foundation every other plan depends on. All shared code (API client, types, stores, hooks, layout) lives here so feature pages can be built independently in parallel.
Output: Working app shell with routing, theme, and infrastructure. Feature pages are placeholder stubs.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/95-react-frontend/95-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scaffold Vite + React 19 project with all dependencies</name>
  <files>
    frontend/package.json
    frontend/vite.config.ts
    frontend/tsconfig.json
    frontend/tsconfig.app.json
    frontend/index.html
    frontend/components.json
    frontend/src/globals.css
    frontend/src/lib/utils.ts
    frontend/src/components/ui/*
  </files>
  <action>
    1. Run `npm create vite@latest frontend -- --template react-ts` from the project root.

    2. `cd frontend` and install all dependencies:
       ```bash
       npm install tailwindcss @tailwindcss/vite
       npm install recharts @tanstack/react-table
       npm install zustand react-router
       npm install lucide-react
       ```

    3. Update `vite.config.ts` to include Tailwind v4 plugin, path alias (`@` -> `./src`), and proxy config:
       ```typescript
       import path from "path";
       import tailwindcss from "@tailwindcss/vite";
       import react from "@vitejs/plugin-react";
       import { defineConfig } from "vite";

       export default defineConfig({
         plugins: [react(), tailwindcss()],
         resolve: {
           alias: {
             "@": path.resolve(__dirname, "./src"),
           },
         },
         server: {
           proxy: {
             '/api': {
               target: 'http://localhost:8080',
               changeOrigin: true,
             },
           },
         },
       });
       ```

    4. Run `npx shadcn@latest init` -- select: New York style, Neutral base color, CSS variables yes. This generates `components.json`, updates `globals.css`, and creates `src/lib/utils.ts` with the `cn()` helper.

    5. Add shadcn components needed across the app:
       ```bash
       npx shadcn@latest add button card badge input select tabs separator scroll-area tooltip toggle skeleton sidebar sheet dropdown-menu
       ```

    6. Replace `globals.css` content with the full oklch CSS variable set from the research (copy the exact `:root` and `.dark` blocks from the research section "Pattern 5: Theme System"). Include the `@import "tailwindcss"` directive at the top (Tailwind v4 style -- NOT the old `@tailwind base` directives). Include Inter and JetBrains Mono font-face declarations. Add `@custom-variant dark (&:where(.dark, .dark *));` for dark mode variant.

    7. Set `font-family: 'Inter', sans-serif` on the body in globals.css. Set `font-family: 'JetBrains Mono', monospace` for code elements.

    8. Verify `npm run dev` starts without errors and the page loads.
  </action>
  <verify>
    Run `cd frontend && npm run dev -- --host 2>&1 | head -5` and confirm Vite dev server starts.
    Run `ls frontend/src/components/ui/` and confirm shadcn components exist.
  </verify>
  <done>
    Vite dev server starts on localhost:5173, shadcn components installed, Tailwind v4 CSS compiles, globals.css has oklch theme variables for both light and dark modes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Build app shell with sidebar, header, routing, and all shared infrastructure</name>
  <files>
    frontend/src/main.tsx
    frontend/src/app.tsx
    frontend/src/types/api.ts
    frontend/src/lib/api.ts
    frontend/src/hooks/use-websocket.ts
    frontend/src/hooks/use-theme.ts
    frontend/src/stores/project-store.ts
    frontend/src/stores/ws-store.ts
    frontend/src/stores/ui-store.ts
    frontend/src/components/layout/app-sidebar.tsx
    frontend/src/components/layout/header.tsx
    frontend/src/components/layout/push-panel.tsx
    frontend/src/pages/dashboard.tsx
    frontend/src/pages/issues.tsx
    frontend/src/pages/events.tsx
    frontend/src/pages/live-stream.tsx
    frontend/src/pages/alerts.tsx
    frontend/src/pages/settings.tsx
  </files>
  <action>
    **TypeScript Types (`src/types/api.ts`):**
    Define all types matching backend JSON shapes as documented in the research:
    - Dashboard: VolumePoint, LevelBreakdown, TopIssue, HealthSummary
    - Issues: Issue, PaginatedResponse<T>
    - Events: EventSummary, EventDetail (with navigation)
    - Alerts: AlertRule, Alert (with condition/action objects)
    - Settings: ProjectSettings, ProjectStorage
    - Team: Member, ApiKey
    - WebSocket: WsMessage discriminated union (event | issue | issue_count | alert | filters_updated | error)
    - ActionResponse: { status: string; affected: number; }
    - IssueFilterParams, EventFilterParams for query string building

    **API Client (`src/lib/api.ts`):**
    Create a typed fetch wrapper as shown in research Pattern 4. Build the full `api` object with namespaces for all endpoint groups:
    - `api.dashboard.*` (volume, levels, topIssues, health, tags)
    - `api.issues.*` (list, events, timeline, resolve, archive, unresolve, assign, discard, delete)
    - `api.events.*` (search, byTag, detail)
    - `api.alerts.*` (rules, createRule, toggleRule, deleteRule, list, acknowledge, resolve)
    - `api.team.*` (members, addMember, updateRole, removeMember, apiKeys, createKey, revokeKey)
    - `api.settings.*` (get, update, storage)
    Include a `toQueryString` helper for converting filter param objects to URL query strings. Use keyset pagination params (cursor, cursor_id, limit) per research.

    **Zustand Stores:**
    - `project-store.ts`: `{ projects: [{id, name}], activeProjectId: string | null, setActiveProject, setProjects }`. Hardcode a default project for development (id: "default", name: "Default Project") since org/project CRUD endpoints don't exist yet.
    - `ws-store.ts`: `{ status: 'connecting'|'connected'|'disconnected', lastEvent: WsMessage|null, eventCount: number, setStatus, onMessage }`. The onMessage handler dispatches by message type.
    - `ui-store.ts`: `{ sidebarOpen: boolean, detailPanel: { type: 'event'|'issue', id: string } | null, toggleSidebar, openDetail, closeDetail }`.

    **Hooks:**
    - `use-websocket.ts`: Custom hook with exponential backoff as shown in research Pattern 2. Takes `projectId: string | null`, connects to `/ws/stream/projects/${projectId}` (through Vite proxy), dispatches messages to ws-store. Max retry delay: 30s. Add jitter. Clean up on unmount.
    - `use-theme.ts`: Simple hook that reads/writes `dark` class on `<html>` element. Persist preference to localStorage key `mesher-theme`. Default to system preference via `matchMedia('(prefers-color-scheme: dark)')`.

    **Layout Components:**
    - `app-sidebar.tsx`: Uses shadcn Sidebar component. Has two sections:
      1. Projects section at top: list of projects from project-store (compact rows, click to set active). Currently shows hardcoded "Default Project".
      2. Navigation section: 6 items (Dashboard, Issues, Events, Live Stream, Alerts, Settings) using lucide-react icons (LayoutDashboard, CircleDot, List, Radio, Bell, Settings). Active item highlighted. Uses React Router `NavLink` for active state.
    - `header.tsx`: Minimal header bar with: page title (from route), WebSocket status dot (green circle when connected, red when disconnected, yellow when connecting -- 8px dot), theme toggle button (Sun/Moon icons from lucide-react).
    - `push-panel.tsx`: Implements research Pattern 3. Renders `children` (main content) in a flex container. When `panel` prop is non-null, renders the panel on the right with a border-left, and the main content shrinks. Panel width: `w-[480px]`. Smooth transition via `transition-all duration-200`.

    **Router Setup (`main.tsx`):**
    Use React Router v7 in library mode. Create a `BrowserRouter` with routes:
    - `/` -> redirect to `/dashboard`
    - `/dashboard` -> Dashboard page
    - `/issues` -> Issues page
    - `/events` -> Events page
    - `/live` -> Live Stream page
    - `/alerts` -> Alerts page
    - `/settings` -> Settings page

    **App Layout (`app.tsx`):**
    Root component wrapping the sidebar provider, sidebar, header, and router outlet in a flex layout. The sidebar is on the left (persistent, always visible). The header + content area take the remaining width. Content area renders the router Outlet.

    **Page Stubs:**
    Create 6 page files, each as a simple component with the page name as heading text. These will be filled in by subsequent plans.

    **Important implementation notes:**
    - All colors use CSS variables (e.g., `text-foreground`, `bg-card`), never hardcoded gray values
    - Linear-inspired aesthetic: clean, minimal, subtle borders, monochrome
    - No accent color -- monochrome palette only. Semantic status colors (red/yellow/green) only for status indicators
    - WebSocket connection established in app.tsx level (single connection per active project)
  </action>
  <verify>
    Run `cd frontend && npx tsc --noEmit` to verify TypeScript compilation.
    Run `cd frontend && npm run dev -- --host 2>&1 | head -5` to confirm dev server starts.
    Manually verify in a browser: sidebar with nav items visible, clicking nav items changes routes, theme toggle works.
  </verify>
  <done>
    App shell renders with persistent sidebar (projects section + 6 nav items), header with WS status dot and theme toggle, content area showing page stubs via routing. All shared infrastructure (API client, types, stores, hooks) compiles without errors. Dark/light theme toggle functional.
  </done>
</task>

</tasks>

<verification>
1. `cd frontend && npm run dev` starts Vite dev server without errors
2. `cd frontend && npx tsc --noEmit` passes with no type errors
3. Browser at localhost:5173 shows sidebar with navigation, header with status dot and theme toggle
4. Clicking navigation items changes the displayed page stub
5. Theme toggle switches between light and dark mode
6. All shadcn UI components installed and importable
</verification>

<success_criteria>
- Working React 19 + Vite + Tailwind v4 + shadcn project in `frontend/` directory
- App shell: sidebar (projects + nav), header (WS dot + theme toggle), content (router outlet)
- 6 routes rendering placeholder page stubs
- Complete TypeScript type definitions for all backend API shapes
- Typed API client covering all 30+ backend endpoints
- WebSocket hook with exponential backoff reconnection
- Zustand stores for projects, WebSocket state, and UI state
- Theme toggle with localStorage persistence
- Monochrome oklch theme matching Mesh landing page
</success_criteria>

<output>
After completion, create `.planning/phases/95-react-frontend/95-01-SUMMARY.md`
</output>
