---
phase: 95-react-frontend
plan: 02
type: execute
wave: 2
depends_on: ["95-01"]
files_modified:
  - frontend/src/pages/dashboard.tsx
  - frontend/src/components/charts/volume-chart.tsx
  - frontend/src/components/charts/level-chart.tsx
  - frontend/src/components/charts/health-chart.tsx
  - frontend/src/components/shared/issue-row.tsx
  - frontend/src/components/shared/status-badge.tsx
autonomous: true

must_haves:
  truths:
    - "Dashboard page renders a split view with charts on the left and an issue list on the right"
    - "Event volume chart shows time-series data from the dashboard/volume API endpoint"
    - "Error level breakdown chart shows severity distribution from the dashboard/levels API endpoint"
    - "Health/unresolved trend chart shows health metrics from the dashboard/health API endpoint"
    - "Issue list shows compact single-line rows (title, count, last seen) from the dashboard/top-issues API endpoint"
  artifacts:
    - path: "frontend/src/pages/dashboard.tsx"
      provides: "Split-view dashboard page with charts left, issues right"
    - path: "frontend/src/components/charts/volume-chart.tsx"
      provides: "Recharts AreaChart for event volume over time"
    - path: "frontend/src/components/charts/level-chart.tsx"
      provides: "Recharts BarChart for error level breakdown"
    - path: "frontend/src/components/charts/health-chart.tsx"
      provides: "Recharts LineChart for health/unresolved trend"
    - path: "frontend/src/components/shared/issue-row.tsx"
      provides: "Compact single-line issue row component"
  key_links:
    - from: "frontend/src/pages/dashboard.tsx"
      to: "frontend/src/lib/api.ts"
      via: "API calls for dashboard data"
      pattern: "api\\.dashboard"
    - from: "frontend/src/components/charts/volume-chart.tsx"
      to: "recharts"
      via: "AreaChart import"
      pattern: "import.*AreaChart.*from.*recharts"
    - from: "frontend/src/pages/dashboard.tsx"
      to: "frontend/src/stores/ws-store.ts"
      via: "Live event count updates"
      pattern: "useWsStore"
---

<objective>
Build the Dashboard page (UI-01, UI-08) with a split-view layout: left panel containing three Recharts charts (event volume over time, error level breakdown, health/unresolved trend), and right panel containing a compact issue list. Dashboard data fetched from REST API with loading skeletons. Charts styled with CSS variables for theme consistency.

Purpose: The dashboard is the landing page and primary interaction point. Charts visualize platform health at a glance, while the issue list provides immediate access to the most important issues.
Output: Fully functional Dashboard page with live data from API endpoints.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/95-react-frontend/95-RESEARCH.md
@.planning/phases/95-react-frontend/95-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Recharts chart components with CSS variable theming</name>
  <files>
    frontend/src/components/charts/volume-chart.tsx
    frontend/src/components/charts/level-chart.tsx
    frontend/src/components/charts/health-chart.tsx
    frontend/src/components/shared/status-badge.tsx
  </files>
  <action>
    **Volume Chart (`volume-chart.tsx`):**
    Recharts AreaChart wrapped in ResponsiveContainer (height 240px). Props: `data: VolumePoint[]`, `bucket: 'hour' | 'day'`.
    - X-axis: bucket timestamp, formatted as time (HH:MM) for hourly, date (MMM DD) for daily
    - Y-axis: event count, auto-scaled
    - Area fill uses `hsl(var(--muted))`, stroke uses `hsl(var(--foreground))`, strokeWidth 1.5
    - CartesianGrid with `hsl(var(--border))`, vertical lines hidden
    - Tooltip with card-styled background using CSS variables
    - Axes: no axis line, no tick line, `hsl(var(--muted-foreground))` text, 12px font

    **Level Chart (`level-chart.tsx`):**
    Recharts BarChart wrapped in ResponsiveContainer (height 200px). Props: `data: LevelBreakdown[]`.
    - X-axis: level name (error, warning, info, debug)
    - Y-axis: count
    - Bars use semantic colors ONLY for this chart:
      - error: `oklch(0.577 0.245 27.325)` (destructive red)
      - warning: `oklch(0.75 0.18 85)` (amber/yellow)
      - info: `hsl(var(--muted-foreground))` (monochrome)
      - debug: `hsl(var(--muted))` (lighter monochrome)
    - A `getLevelColor` helper function maps level string to color
    - Tooltip styled same as volume chart

    **Health Chart (`health-chart.tsx`):**
    Recharts LineChart wrapped in ResponsiveContainer (height 200px). Props: `data: HealthSummary` (single snapshot, not time-series).
    - Display as stat cards rather than a line chart since health endpoint returns a single snapshot, not time-series data
    - Three stat cards in a row: "Unresolved Issues" (count), "Events (24h)" (count), "New Today" (count)
    - Use shadcn Card component for each stat
    - Large number in `text-foreground`, label in `text-muted-foreground`
    - If unresolved_count > 0, show count with a small red dot indicator

    **Status Badge (`status-badge.tsx`):**
    Reusable badge component for issue/event status and severity levels.
    - Props: `variant: 'error' | 'warning' | 'info' | 'debug' | 'resolved' | 'archived' | 'unresolved'`
    - Error/warning use semantic colors; all others use monochrome variants
    - Uses shadcn Badge as base with variant overrides
  </action>
  <verify>
    Run `cd frontend && npx tsc --noEmit` to verify all chart components compile.
    Verify chart components export correctly by checking import resolution.
  </verify>
  <done>
    Three chart components and status badge render correctly with CSS variable theming. Volume chart shows time-series area, level chart shows colored bars, health displays stat cards. All use the monochrome theme with semantic colors only for severity levels.
  </done>
</task>

<task type="auto">
  <name>Task 2: Build Dashboard page with split-view layout and data fetching</name>
  <files>
    frontend/src/pages/dashboard.tsx
    frontend/src/components/shared/issue-row.tsx
  </files>
  <action>
    **Issue Row (`issue-row.tsx`):**
    Compact single-line row component for the dashboard issue list. Linear-style density.
    - Props: `issue: TopIssue, onClick?: () => void`
    - Layout: title (truncated, medium weight, flex-1) | event count (tabular-nums, muted) | last seen (relative time, muted)
    - Status badge (from status-badge.tsx) before the title
    - Hover state: subtle background change using `hover:bg-accent`
    - Cursor pointer when onClick provided
    - `formatRelativeTime` utility: converts ISO timestamp to "2m ago", "3h ago", "1d ago" etc.

    **Dashboard Page (`dashboard.tsx`):**
    Split-view layout implementing the locked decision: left panel for charts/stats, right panel for live issue list, equal weight to both.

    Layout structure:
    ```
    <div className="flex h-full gap-6 p-6">
      <div className="flex-1 space-y-6">  <!-- Left: Charts -->
        <HealthStats />
        <VolumeChart />
        <LevelChart />
      </div>
      <div className="flex-1">  <!-- Right: Issue List -->
        <IssueList />
      </div>
    </div>
    ```

    Data fetching:
    - Use `useEffect` + `useState` to fetch dashboard data on mount and when activeProjectId changes
    - Fetch all 4 endpoints in parallel: `Promise.all([api.dashboard.volume(...), api.dashboard.levels(...), api.dashboard.topIssues(...), api.dashboard.health(...)])`
    - Show shadcn Skeleton components while loading (skeleton bars for charts, skeleton rows for issues)
    - Handle error state with a simple "Failed to load dashboard" message

    Issue list section:
    - Header: "Issues" with count badge
    - Scrollable list of IssueRow components
    - Show "No issues found" empty state when list is empty
    - Clicking an issue row opens the detail panel (via ui-store.openDetail)

    WebSocket live updates:
    - Subscribe to ws-store's lastEvent
    - When a new `event` message arrives, increment the volume chart's latest bucket count
    - When an `issue_count` message arrives, update the health stats unresolved_count
    - When an `issue` message arrives with action "resolved"/"archived", visually indicate the change

    Include a time range selector at the top of the charts section: "Last 24 hours" / "Last 7 days" toggle that switches the volume chart bucket parameter between 'hour' and 'day'.
  </action>
  <verify>
    Run `cd frontend && npx tsc --noEmit` to verify Dashboard page compiles.
    Run `cd frontend && npm run build` to verify production build succeeds.
  </verify>
  <done>
    Dashboard page renders split-view with charts on left (health stats, volume area chart, level bar chart) and scrollable issue list on right. Data fetched from API with loading skeletons. Time range toggle switches between hourly and daily views. Issue rows are compact, Linear-style, and clickable.
  </done>
</task>

</tasks>

<verification>
1. `cd frontend && npx tsc --noEmit` passes
2. `cd frontend && npm run build` succeeds
3. Dashboard page at `/dashboard` shows split-view layout
4. Charts render with appropriate placeholder data shapes (empty state when no API)
5. Issue list renders compact rows with title, count, last seen
6. Loading skeletons appear before data loads
</verification>

<success_criteria>
- Dashboard renders split-view: charts left, issues right (equal weight per locked decision)
- Three chart types implemented: event volume (AreaChart), error levels (BarChart), health stats (stat cards)
- Compact issue rows with Linear-style density (title, count, last seen)
- All charts use CSS variable theming for dark/light mode
- Loading skeletons during data fetch
- Time range selector (24h / 7d) for volume chart
- WebSocket store integration for live updates
</success_criteria>

<output>
After completion, create `.planning/phases/95-react-frontend/95-02-SUMMARY.md`
</output>
