---
phase: 70-scaffold-design-system
plan: 02
type: execute
wave: 2
depends_on: ["70-01"]
files_modified:
  - website/.vitepress/theme/components/ThemeToggle.vue
  - website/.vitepress/theme/components/NavBar.vue
  - website/.vitepress/theme/Layout.vue
autonomous: false

must_haves:
  truths:
    - "A NavBar is visible at the top of every page with the Mesh wordmark, navigation links, and theme toggle"
    - "Clicking the theme toggle switches between dark and light mode visually"
    - "The dark/light mode choice persists across page reloads (localStorage)"
    - "There is no flash of wrong theme (FOUC) on initial page load"
  artifacts:
    - path: "website/.vitepress/theme/components/ThemeToggle.vue"
      provides: "Dark/light mode toggle button using VitePress isDark + useToggle"
      contains: "useData"
    - path: "website/.vitepress/theme/components/NavBar.vue"
      provides: "Top navigation bar with logo, links, and theme toggle"
      contains: "ThemeToggle"
    - path: "website/.vitepress/theme/Layout.vue"
      provides: "Root layout with NavBar and Content"
      contains: "NavBar"
  key_links:
    - from: "website/.vitepress/theme/components/ThemeToggle.vue"
      to: "VitePress isDark"
      via: "useData() from vitepress"
      pattern: "useData\\(\\)"
    - from: "website/.vitepress/theme/components/ThemeToggle.vue"
      to: "shadcn-vue Button"
      via: "import from @/components/ui/button"
      pattern: "import.*Button.*@/components/ui/button"
    - from: "website/.vitepress/theme/components/NavBar.vue"
      to: "website/.vitepress/theme/components/ThemeToggle.vue"
      via: "import and render in template"
      pattern: "import ThemeToggle"
    - from: "website/.vitepress/theme/Layout.vue"
      to: "website/.vitepress/theme/components/NavBar.vue"
      via: "import and render before Content"
      pattern: "import NavBar"
---

<objective>
Create the NavBar component with logo, navigation links, and dark/light mode toggle, then wire it into the root Layout. This completes the visible shell that every subsequent page builds on.

Purpose: INFRA-04 (dark/light mode toggle with persistence), INFRA-05 (FOUC prevention -- already automatic from Plan 01's appearance:true), and NAV-05 (NavBar with logo, links, toggle). After this plan, developers can visit the site and see the styled shell.

Design note on INFRA-04: The requirement text references "VueUse useDark()" but this implementation uses VitePress `useData().isDark` instead. This is intentional -- per research Pitfall 3, using VueUse's `useDark()` alongside VitePress creates dual localStorage keys that fight each other, causing theme flicker. VitePress's built-in `isDark` ref writes to the same `vitepress-theme-appearance` key that the FOUC-prevention inline script reads, keeping everything in sync.

Output: NavBar.vue, ThemeToggle.vue, updated Layout.vue. Visually verified by user.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/70-scaffold-design-system/70-RESEARCH.md
@.planning/phases/70-scaffold-design-system/70-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ThemeToggle and NavBar components, wire into Layout</name>
  <files>
    website/.vitepress/theme/components/ThemeToggle.vue
    website/.vitepress/theme/components/NavBar.vue
    website/.vitepress/theme/Layout.vue
  </files>
  <action>
Create three Vue components:

1. Create website/.vitepress/theme/components/ThemeToggle.vue:
   - Import { useData } from 'vitepress' (NOT useDark from @vueuse/core -- see research Pitfall 3)
   - Import { useToggle } from '@vueuse/core'
   - Import { Sun, Moon } from 'lucide-vue-next'
   - Import { Button } from '@/components/ui/button'
   - Destructure isDark from useData()
   - Create toggleDark = useToggle(isDark)
   - Template: shadcn-vue Button (variant="ghost", size="icon") wrapping Sun and Moon icons
   - Sun icon: visible in light mode (rotate-0 scale-100), hidden in dark (dark:-rotate-90 dark:scale-0)
   - Moon icon: hidden in light (rotate-90 scale-0), visible in dark (dark:rotate-0 dark:scale-100), positioned absolute
   - Include sr-only span "Toggle theme" for accessibility
   - Use the EXACT template from 70-RESEARCH.md ThemeToggle example

2. Create website/.vitepress/theme/components/NavBar.vue:
   - Import ThemeToggle from './ThemeToggle.vue'
   - Template structure:
     - `<header>` with classes: sticky top-0 z-50 w-full border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60
     - Inner `<div>` with: mx-auto flex h-14 max-w-7xl items-center justify-between px-4
     - Left: `<a href="/">` with "Mesh" text as wordmark (font-semibold text-foreground). Use text, not an image logo for now.
     - Center: `<nav>` with links (hidden on mobile via "hidden md:flex"):
       - "Docs" linking to "/docs/getting-started/" (placeholder, will work in later phases)
       - "GitHub" linking to the repo (use "https://github.com/user/mesh" as placeholder)
       - Links styled: text-muted-foreground transition-colors hover:text-foreground
     - Right: `<div>` containing ThemeToggle component
   - Use the EXACT template structure from 70-RESEARCH.md NavBar example

3. Update website/.vitepress/theme/Layout.vue:
   - Add `<script setup>` importing NavBar from './components/NavBar.vue'
   - Template: outer div with min-h-screen bg-background text-foreground
   - Render NavBar before main content area
   - main element with mx-auto max-w-4xl px-4 py-8, rendering `<Content />`
   - Use the EXACT layout structure from 70-RESEARCH.md Pattern 2

After creating components, run `cd website && npm run dev` and verify:
- NavBar appears at top with "Mesh" wordmark, "Docs" and "GitHub" links, and a sun/moon toggle button
- Clicking the toggle switches dark/light mode (background changes from white to near-black)
- Refreshing the page preserves the chosen mode (no FOUC)
- On narrow viewport (< 768px), navigation links hide but toggle remains visible
  </action>
  <verify>
Run `cd website && npm run dev`. Open browser to the dev server URL. Verify NavBar renders at top. Click theme toggle -- mode switches. Refresh page -- mode persists. Check DevTools console for zero errors. Run `cd website && npm run build` to confirm production build succeeds.
  </verify>
  <done>
NavBar visible at top of page with Mesh wordmark, Docs link, GitHub link, and theme toggle button. Theme toggle switches between dark and light mode. Mode persists across page refresh. No FOUC on initial load. Production build succeeds.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Visual verification of styled shell</name>
  <files>
    website/.vitepress/theme/components/ThemeToggle.vue
    website/.vitepress/theme/components/NavBar.vue
    website/.vitepress/theme/Layout.vue
  </files>
  <action>
This is a visual verification checkpoint. All implementation is complete from Task 1. Present the running dev server to the user for approval of the visual design, dark/light mode behavior, and FOUC prevention.
  </action>
  <what-built>
Complete VitePress site shell with:
- Custom theme (no default VitePress styles)
- Monochrome OKLCH design system via Tailwind v4 + shadcn-vue
- NavBar with Mesh wordmark, navigation links, and dark/light mode toggle
- FOUC prevention on page load
  </what-built>
  <how-to-verify>
1. Run `cd website && npm run dev` (if not already running)
2. Open the URL shown in terminal (likely http://localhost:5173)
3. Verify light mode: white/near-white background, dark text, NavBar at top with "Mesh" wordmark
4. Click the sun/moon toggle button in the NavBar
5. Verify dark mode: dark/near-black background, light text, NavBar adapts
6. Refresh the page -- verify the chosen mode persists (no flash of white then dark or vice versa)
7. Resize browser to mobile width (< 768px) -- verify nav links hide but toggle remains
8. Check that no default VitePress styles appear (no blue sidebar, no default header/footer)
9. Verify the "Mesh" heading from docs/index.md renders in the main content area
  </how-to-verify>
  <verify>User confirms visual appearance is correct by typing "approved".</verify>
  <done>User has visually approved the styled shell including NavBar, dark/light toggle, FOUC prevention, and responsive behavior.</done>
  <resume-signal>Type "approved" or describe any visual issues</resume-signal>
</task>

</tasks>

<verification>
1. NavBar renders at top of page on all routes
2. ThemeToggle uses VitePress isDark (not VueUse useDark) -- check import in ThemeToggle.vue
3. Dark mode toggle works bidirectionally
4. LocalStorage key is "vitepress-theme-appearance" (VitePress built-in, not custom)
5. No FOUC on fresh page load in either mode
6. Responsive: nav links hidden on mobile, toggle always visible
7. All text and backgrounds use monochrome OKLCH colors (zero chroma)
</verification>

<success_criteria>
- NavBar visible with Mesh wordmark, navigation links, and theme toggle
- Dark/light mode toggle works and persists across reloads
- No FOUC on initial page load
- Monochrome design system renders correctly in both modes
- User visually approves the shell
</success_criteria>

<output>
After completion, create `.planning/phases/70-scaffold-design-system/70-02-SUMMARY.md`
</output>
