---
phase: 73-extended-content-polish
plan: 03
type: execute
wave: 2
depends_on: ["73-01", "73-02"]
files_modified:
  - website/docs/.vitepress/config.mts
  - website/docs/.vitepress/theme/Layout.vue
  - website/docs/.vitepress/theme/components/NavBar.vue
  - website/docs/.vitepress/theme/components/docs/DocsLayout.vue
  - website/docs/.vitepress/theme/components/docs/DocsEditLink.vue
  - website/docs/.vitepress/theme/components/docs/DocsLastUpdated.vue
  - website/docs/.vitepress/theme/components/docs/DocsVersionBadge.vue
  - website/docs/.vitepress/theme/components/NotFoundPage.vue
  - website/docs/.vitepress/theme/styles/code.css
  - website/docs/.vitepress/theme/styles/main.css
autonomous: true

must_haves:
  truths:
    - "Typing in the search box returns relevant documentation pages"
    - "Hovering over a code block reveals a copy-to-clipboard button"
    - "Every page has og:title and og:description meta tags in the HTML head"
    - "Navigating to a non-existent URL shows a custom 404 page"
    - "Each docs page shows an Edit on GitHub link"
    - "Each docs page shows a last-updated timestamp"
    - "A version badge displays the current Mesh version (0.1.0)"
    - "Sidebar navigation includes Web, Databases, Distributed Actors, and Developer Tools sections"
  artifacts:
    - path: "website/docs/.vitepress/config.mts"
      provides: "Search, lastUpdated, editLink, SEO, expanded sidebar config"
      contains: "search"
    - path: "website/docs/.vitepress/theme/components/NotFoundPage.vue"
      provides: "Custom 404 page component"
      min_lines: 15
    - path: "website/docs/.vitepress/theme/components/docs/DocsEditLink.vue"
      provides: "Edit on GitHub link component"
      min_lines: 10
    - path: "website/docs/.vitepress/theme/components/docs/DocsLastUpdated.vue"
      provides: "Last-updated timestamp component"
      min_lines: 10
    - path: "website/docs/.vitepress/theme/components/docs/DocsVersionBadge.vue"
      provides: "Version badge component"
      min_lines: 8
  key_links:
    - from: "website/docs/.vitepress/theme/components/NavBar.vue"
      to: "vitepress/theme"
      via: "VPNavBarSearch import"
      pattern: "VPNavBarSearch"
    - from: "website/docs/.vitepress/theme/Layout.vue"
      to: "website/docs/.vitepress/theme/components/NotFoundPage.vue"
      via: "page.isNotFound conditional"
      pattern: "isNotFound"
    - from: "website/docs/.vitepress/theme/components/docs/DocsLayout.vue"
      to: "website/docs/.vitepress/theme/components/docs/DocsEditLink.vue"
      via: "component import and render"
      pattern: "DocsEditLink"
    - from: "website/docs/.vitepress/config.mts"
      to: "VitePress build pipeline"
      via: "transformPageData hook for SEO"
      pattern: "transformPageData"
---

<objective>
Add production-quality site features: search, copy-to-clipboard, SEO, 404 page, edit links, last-updated timestamps, version badge, and expanded sidebar with all four new doc sections.

Purpose: Fulfills FEAT-01 through FEAT-07 and wires the new docs pages from plans 73-01 and 73-02 into the sidebar navigation, completing the documentation site.
Output: Fully polished documentation site with all production features enabled.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/73-extended-content-polish/73-RESEARCH.md

# Prior plan summaries needed for understanding component structure
@.planning/phases/72-docs-infrastructure-core-content/72-01-SUMMARY.md
@.planning/phases/72-docs-infrastructure-core-content/72-02-SUMMARY.md

# Files being modified -- read these first
@website/docs/.vitepress/config.mts
@website/docs/.vitepress/theme/Layout.vue
@website/docs/.vitepress/theme/components/NavBar.vue
@website/docs/.vitepress/theme/components/docs/DocsLayout.vue
@website/docs/.vitepress/theme/styles/code.css
@website/docs/.vitepress/theme/styles/main.css
@website/docs/.vitepress/theme/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: VitePress config (search, SEO, lastUpdated, editLink, sidebar) and search in NavBar</name>
  <files>
    website/docs/.vitepress/config.mts
    website/docs/.vitepress/theme/components/NavBar.vue
    website/docs/.vitepress/theme/styles/main.css
  </files>
  <action>
**config.mts modifications:**

1. Add `lastUpdated: true` at the top level of the defineConfig object (enables git-based timestamps).

2. Add `head` array at the top level for site-wide SEO defaults:
```typescript
head: [
  ['meta', { property: 'og:site_name', content: 'Mesh Programming Language' }],
  ['meta', { name: 'twitter:card', content: 'summary' }],
],
```

3. Add `transformPageData` hook at the top level for per-page SEO:
```typescript
transformPageData(pageData) {
  const canonicalUrl = `https://meshlang.org/${pageData.relativePath}`
    .replace(/index\.md$/, '')
    .replace(/\.md$/, '.html')
  pageData.frontmatter.head ??= []
  pageData.frontmatter.head.push(
    ['link', { rel: 'canonical', href: canonicalUrl }],
    ['meta', { property: 'og:title', content: pageData.title + ' | Mesh' }],
    ['meta', { property: 'og:description', content: pageData.description }],
    ['meta', { property: 'og:url', content: canonicalUrl }],
    ['meta', { property: 'og:type', content: 'article' }],
  )
},
```

4. Add to themeConfig:
```typescript
search: { provider: 'local' },
editLink: {
  pattern: 'https://github.com/user/mesh/edit/main/website/docs/:path',
  text: 'Edit this page on GitHub',
},
meshVersion: '0.1.0',
```

5. Expand the sidebar `/docs/` array to include 4 new sections (after the existing Language Guide group, before Reference). The new groups:
```typescript
{
  text: 'Web & Networking',
  collapsed: false,
  items: [
    { text: 'Web', link: '/docs/web/' },
  ],
},
{
  text: 'Data',
  collapsed: false,
  items: [
    { text: 'Databases', link: '/docs/databases/' },
  ],
},
{
  text: 'Distribution',
  collapsed: false,
  items: [
    { text: 'Distributed Actors', link: '/docs/distributed/' },
  ],
},
{
  text: 'Tooling',
  collapsed: false,
  items: [
    { text: 'Developer Tools', link: '/docs/tooling/' },
  ],
},
```

**NavBar.vue modifications:**

Add the VPNavBarSearch component. Import `VPNavBarSearch` from `vitepress/theme` at the top of the script section. Place it in the right-side div, BEFORE the ThemeToggle:
```vue
<div class="flex items-center gap-2">
  <VPNavBarSearch />
  <ThemeToggle />
</div>
```

**main.css modifications:**

Add VitePress CSS variable mappings for the search component at the end of the `:root` block. VPNavBarSearch uses `--vp-c-*` variables internally. Map them to our OKLCH palette:
```css
/* VitePress search component CSS variable bridge */
:root {
  --vp-c-bg: var(--background);
  --vp-c-bg-soft: var(--muted);
  --vp-c-bg-alt: var(--secondary);
  --vp-c-text-1: var(--foreground);
  --vp-c-text-2: var(--muted-foreground);
  --vp-c-text-3: var(--muted-foreground);
  --vp-c-divider: var(--border);
  --vp-c-brand-1: var(--foreground);
  --vp-c-brand-2: var(--muted-foreground);
  --vp-c-brand-3: var(--foreground);
  --vp-c-default-soft: var(--accent);
  --vp-font-family-base: inherit;
  --vp-font-family-mono: ui-monospace, SFMono-Regular, 'SF Mono', Menlo, Consolas, monospace;
  --vp-shadow-1: 0 1px 2px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.06);
  --vp-shadow-2: 0 3px 12px rgba(0, 0, 0, 0.07), 0 1px 4px rgba(0, 0, 0, 0.07);
  --vp-shadow-3: 0 12px 32px rgba(0, 0, 0, 0.1), 0 2px 6px rgba(0, 0, 0, 0.08);
  --vp-z-index-local-nav: 10;
  --vp-z-index-nav: 20;
  --vp-z-index-layout-top: 30;
  --vp-z-index-backdrop: 40;
  --vp-z-index-sidebar: 50;
  --vp-z-index-footer: 60;
}
.dark {
  --vp-shadow-1: 0 1px 2px rgba(0, 0, 0, 0.24), 0 1px 2px rgba(0, 0, 0, 0.36);
  --vp-shadow-2: 0 3px 12px rgba(0, 0, 0, 0.36), 0 1px 4px rgba(0, 0, 0, 0.32);
  --vp-shadow-3: 0 12px 32px rgba(0, 0, 0, 0.4), 0 2px 6px rgba(0, 0, 0, 0.32);
}
```

Note: Add the `--vp-*` variables in a SEPARATE `:root` / `.dark` block at the END of main.css (after the existing `@layer base` block) -- do NOT merge them into the existing `:root` block that contains the OKLCH theme variables. This keeps the VitePress bridge CSS clearly separated.
  </action>
  <verify>
Run `cd /Users/sn0w/Documents/dev/snow/website && npm run build` -- build must succeed with no dead link errors (all 4 new doc pages must exist from plans 73-01 and 73-02). Check config.mts has `search`, `lastUpdated`, `editLink`, `transformPageData`, and expanded sidebar. Check NavBar.vue imports VPNavBarSearch.
  </verify>
  <done>VitePress config has search, SEO, lastUpdated, editLink, expanded sidebar; NavBar renders search button; CSS variables bridge VitePress search component to OKLCH palette</done>
</task>

<task type="auto">
  <name>Task 2: Copy button CSS, 404 page, edit link, last-updated, and version badge components</name>
  <files>
    website/docs/.vitepress/theme/styles/code.css
    website/docs/.vitepress/theme/components/NotFoundPage.vue
    website/docs/.vitepress/theme/components/docs/DocsEditLink.vue
    website/docs/.vitepress/theme/components/docs/DocsLastUpdated.vue
    website/docs/.vitepress/theme/components/docs/DocsVersionBadge.vue
    website/docs/.vitepress/theme/Layout.vue
    website/docs/.vitepress/theme/components/docs/DocsLayout.vue
  </files>
  <action>
**code.css additions** (append to existing file):

Add copy button styling for VitePress's built-in `<button class="copy">` element. The button is already injected by VitePress's markdown renderer -- we only need CSS. Add the `--vp-icon-copy` CSS variable and all the selectors from the research (Pattern 3): positioned absolutely top-right, opacity 0 by default, opacity 1 on container hover/focus, `.copied` state with "Copied" text, language label that hides when copy button appears.

Also add language label styling: `div[class*='language-'] > span.lang` positioned top-right, fades out when copy button appears on hover.

**NotFoundPage.vue** (new file):

Create a simple 404 page component. Use `useData` to access page data. Display:
- Large "404" heading
- "Page not found" subtext
- A link back to home ("/") styled as a button
- Centered on page with adequate vertical spacing

Style with Tailwind utility classes matching the monochrome theme.

**DocsEditLink.vue** (new file):

Create an edit link component. Use `useData` to get `theme` and `page`. Compute the edit URL by replacing `:path` in `theme.value.editLink.pattern` with `page.value.relativePath`. Render as an anchor with target="_blank", display the `editLink.text` value, and add a small external-link icon from lucide-vue-next (Pencil or ExternalLink icon). Style as muted text that brightens on hover.

**DocsLastUpdated.vue** (new file):

Create a last-updated component. Use `useData` to get `page.value.lastUpdated` (a unix timestamp number). Format as human-readable date using `toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })`. Render as "Last updated: {date}" in muted text. Only render if lastUpdated exists.

**DocsVersionBadge.vue** (new file):

Create a version badge component. Use `useData` to get `theme.meshVersion`. Render as a small pill/badge: `v0.1.0` in a rounded border with muted text. Use Tailwind: `inline-flex items-center rounded-md border border-border px-2 py-0.5 text-xs font-medium text-muted-foreground`.

**Layout.vue modification:**

Add NotFoundPage import. Add `page` to the destructured useData call (alongside frontmatter). Insert `<NotFoundPage v-if="page.isNotFound" />` BEFORE the LandingPage conditional, so 404 is caught first:
```vue
<NotFoundPage v-if="page.isNotFound" />
<LandingPage v-else-if="frontmatter.layout === 'home'" />
<DocsLayout v-else-if="hasSidebar" />
```

**DocsLayout.vue modification:**

Import and render DocsEditLink, DocsLastUpdated, and DocsVersionBadge. Add them below the `<Content />` component and above `<DocsPrevNext>`. Create a footer area between Content and PrevNext:
```vue
<div class="mt-8 flex flex-wrap items-center justify-between gap-4 border-t border-border pt-4 not-prose">
  <DocsEditLink />
  <div class="flex items-center gap-3">
    <DocsVersionBadge />
    <DocsLastUpdated />
  </div>
</div>
```

The `not-prose` class prevents typography plugin from styling the footer.
  </action>
  <verify>
Run `cd /Users/sn0w/Documents/dev/snow/website && npm run build` -- build must succeed. Verify:
1. code.css contains `button.copy` styling and `--vp-icon-copy` variable
2. NotFoundPage.vue exists with "404" text
3. DocsEditLink.vue exists and computes edit URL from theme config
4. DocsLastUpdated.vue exists and formats timestamp
5. DocsVersionBadge.vue exists and reads theme.meshVersion
6. Layout.vue has isNotFound check before other conditionals
7. DocsLayout.vue renders the three footer components
  </verify>
  <done>Copy button appears on code block hover, navigating to /nonexistent shows 404 page, docs pages show edit link + last-updated + version badge footer, build passes</done>
</task>

</tasks>

<verification>
1. `npm run build` succeeds in /website directory
2. Search: config has `search.provider: 'local'`, NavBar imports VPNavBarSearch
3. Copy button: code.css has `button.copy` styles with opacity transition
4. SEO: config has `transformPageData` generating og:title, og:description, canonical URL
5. 404: Layout.vue checks `page.isNotFound` before other routes, NotFoundPage.vue exists
6. Edit link: DocsEditLink.vue reads from `theme.editLink`, config has `editLink.pattern`
7. Last updated: config has `lastUpdated: true`, DocsLastUpdated.vue formats the timestamp
8. Version badge: config has `meshVersion: '0.1.0'`, DocsVersionBadge.vue reads from theme
9. Sidebar: config sidebar has Web, Databases, Distributed Actors, Developer Tools groups
</verification>

<success_criteria>
- All 7 site features (FEAT-01 through FEAT-07) are configured and functional
- 4 new sidebar groups point to the docs pages created in plans 73-01 and 73-02
- VitePress build succeeds with no dead links or errors
- All new Vue components use the established patterns (useData, Tailwind classes, lucide icons)
</success_criteria>

<output>
After completion, create `.planning/phases/73-extended-content-polish/73-03-SUMMARY.md`
</output>
