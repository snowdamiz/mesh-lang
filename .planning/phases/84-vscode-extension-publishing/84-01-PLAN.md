---
phase: 84-vscode-extension-publishing
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - editors/vscode-mesh/package.json
  - editors/vscode-mesh/.vscodeignore
  - editors/vscode-mesh/README.md
  - editors/vscode-mesh/CHANGELOG.md
  - editors/vscode-mesh/images/icon.png
autonomous: true

must_haves:
  truths:
    - "Extension README shows features, requirements, and settings on Marketplace page"
    - "Extension has a visible PNG icon in Marketplace listing"
    - "CHANGELOG documents 0.1.0 and 0.2.0 releases"
    - "VSIX package excludes dev files, source maps, and secrets"
    - "Extension version is 0.2.0 with all marketplace metadata fields"
  artifacts:
    - path: "editors/vscode-mesh/package.json"
      provides: "Marketplace metadata (icon, gallery, repo, keywords, prepublish)"
      contains: "0.2.0"
    - path: "editors/vscode-mesh/README.md"
      provides: "Extension-specific README for Marketplace page"
      contains: "mesh-lang.mesh-lang"
    - path: "editors/vscode-mesh/CHANGELOG.md"
      provides: "Changelog shown on Marketplace"
      contains: "[0.2.0]"
    - path: "editors/vscode-mesh/images/icon.png"
      provides: "256x256 PNG extension icon"
    - path: "editors/vscode-mesh/.vscodeignore"
      provides: "Comprehensive file exclusion for VSIX packaging"
      contains: "src/**"
  key_links:
    - from: "editors/vscode-mesh/package.json"
      to: "editors/vscode-mesh/images/icon.png"
      via: "icon field reference"
      pattern: "\"icon\":\\s*\"images/icon.png\""
    - from: "editors/vscode-mesh/package.json"
      to: "npm run compile"
      via: "vscode:prepublish script"
      pattern: "vscode:prepublish"
---

<objective>
Prepare all marketplace metadata for the Mesh VS Code extension: icon, README, CHANGELOG, comprehensive .vscodeignore, and enhanced package.json with version bump to 0.2.0.

Purpose: The extension needs a complete marketplace presence before publishing. Without proper metadata, the listing shows a blank page with no icon, no description, and no changelog -- making the extension look abandoned or broken.
Output: All files in `editors/vscode-mesh/` ready for `vsce package` to produce a clean, professional VSIX.
</objective>

<execution_context>
@/Users/sn0w/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sn0w/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/84-vscode-extension-publishing/84-RESEARCH.md
@editors/vscode-mesh/package.json
@editors/vscode-mesh/.vscodeignore
@editors/vscode-mesh/src/extension.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create extension icon and marketplace metadata files</name>
  <files>
    editors/vscode-mesh/images/icon.png
    editors/vscode-mesh/README.md
    editors/vscode-mesh/CHANGELOG.md
  </files>
  <action>
Create the icon:
1. Create `editors/vscode-mesh/images/` directory
2. Convert the SVG logo at `website/docs/public/logo-icon-white.svg` to a 256x256 PNG icon. The SVG has white shapes on transparent background. Use `rsvg-convert` if available, otherwise use `sips` on macOS (available at /usr/bin/sips). The icon should have the white Mesh logo on a dark background (#1a1a2e) to match the galleryBanner color. If direct background compositing is not possible with available tools, create a simple PNG by first creating a 256x256 dark background, then overlaying the SVG. As a fallback, if SVG conversion tools are limited, use Python with the `cairosvg` or `pillow` library, or use the `resvg` CLI. The goal is a 256x256 PNG at `editors/vscode-mesh/images/icon.png`.

Create README.md in `editors/vscode-mesh/`:
- Title: "Mesh Language" with VS Code Marketplace version and installs badges (shields.io badges using `mesh-lang.mesh-lang`)
- One-line description linking to https://meshlang.dev
- Features section listing: Syntax Highlighting, Diagnostics, Hover Information, Go to Definition, Completions, Signature Help, Document Symbols
- Image reference: `![Syntax Highlighting](images/screenshot-syntax.png)` (placeholder -- screenshots are a deferred concern, the reference won't break the page)
- Requirements section: mention `meshc` binary is needed, show install command `curl -sSf https://meshlang.dev/install.sh | sh`
- Extension Settings table: `mesh.lsp.path` setting with default `meshc`
- Release Notes section linking to CHANGELOG.md

Create CHANGELOG.md in `editors/vscode-mesh/`:
- Follow Keep a Changelog format (https://keepachangelog.com/en/1.1.0/)
- [0.2.0] - 2026-02-14 section with Added items: Published to VS Code Marketplace and Open VSX, Extension icon and marketplace metadata, Completion suggestions with snippet support, Signature help for function calls, Document symbols (Outline view). Changed items: Enhanced TextMate grammar with comprehensive scope coverage.
- [0.1.0] - 2026-02-07 section with Added items: Initial release, TextMate grammar for syntax highlighting, LSP client connecting to meshc, Hover information, Go-to-definition, Diagnostics.
  </action>
  <verify>
    - `test -f editors/vscode-mesh/images/icon.png && echo "icon exists"`
    - `file editors/vscode-mesh/images/icon.png` shows PNG image
    - `test -f editors/vscode-mesh/README.md && echo "README exists"`
    - `test -f editors/vscode-mesh/CHANGELOG.md && echo "CHANGELOG exists"`
    - README contains "mesh-lang.mesh-lang" badge URL
    - CHANGELOG contains both "[0.2.0]" and "[0.1.0]" sections
  </verify>
  <done>Icon is a valid 256x256 PNG, README has features/requirements/settings, CHANGELOG documents both releases</done>
</task>

<task type="auto">
  <name>Task 2: Enhance package.json and .vscodeignore for marketplace publishing</name>
  <files>
    editors/vscode-mesh/package.json
    editors/vscode-mesh/.vscodeignore
  </files>
  <action>
Update `editors/vscode-mesh/package.json`:
1. Bump version from "0.1.0" to "0.2.0"
2. Update description to: "Mesh language support â€” syntax highlighting, diagnostics, hover, go-to-definition, completions, and signature help"
3. Add `"icon": "images/icon.png"`
4. Add `"galleryBanner": { "color": "#1a1a2e", "theme": "dark" }`
5. Add `"repository": { "type": "git", "url": "https://github.com/mesh-lang/mesh.git" }`
6. Add `"homepage": "https://meshlang.dev"`
7. Add `"bugs": { "url": "https://github.com/mesh-lang/mesh/issues" }`
8. Add `"keywords": ["mesh", "language", "syntax highlighting", "lsp", "actor", "concurrency"]`
9. Add `"pricing": "Free"`
10. Add `"markdown": "github"`
11. Add `"vscode:prepublish": "npm run compile"` to scripts section -- this is CRITICAL, without it `vsce package` produces a VSIX without compiled JS and the extension fails on activation
12. Update `install-local` script version reference from 0.1.0 to 0.2.0
13. Update `@vscode/vsce` devDependency from `^2.22.0` to `^3.7.1` (current version, required for latest marketplace features)
14. Add language icon to the contributes.languages entry: `"icon": { "light": "./images/icon.png", "dark": "./images/icon.png" }`
15. Keep all existing fields (engines, activationEvents, main, contributes, dependencies, etc.) intact

Update `editors/vscode-mesh/.vscodeignore` to be comprehensive:
```
# Source files (compiled to out/)
src/**
**/*.ts
!**/*.d.ts

# Config files
tsconfig.json
.vscode/**
.github/**
.gitignore

# Dev artifacts
node_modules/**
out/**/*.map
**/*.test.js
**/*.spec.js

# Package manager
package-lock.json

# CI/CD
.eslintrc*
.prettierrc*
```

Run `cd editors/vscode-mesh && npm install` to update package-lock.json with the new @vscode/vsce version.
Then run `cd editors/vscode-mesh && npx vsce ls` to verify the package file list looks correct (should include out/, images/, README.md, CHANGELOG.md, syntaxes/, language-configuration.json, package.json but NOT src/, tsconfig.json, node_modules/, package-lock.json).
  </action>
  <verify>
    - `node -e "const p = require('./editors/vscode-mesh/package.json'); console.log(p.version)"` outputs "0.2.0"
    - `node -e "const p = require('./editors/vscode-mesh/package.json'); console.log(p.icon)"` outputs "images/icon.png"
    - `node -e "const p = require('./editors/vscode-mesh/package.json'); console.log(p.scripts['vscode:prepublish'])"` outputs "npm run compile"
    - `cd editors/vscode-mesh && npx vsce ls 2>/dev/null | head -20` shows expected files, no src/ or tsconfig.json
  </verify>
  <done>package.json has version 0.2.0, all marketplace metadata fields, vscode:prepublish script. .vscodeignore comprehensively excludes dev files. `vsce ls` confirms clean package contents.</done>
</task>

</tasks>

<verification>
1. All five target files exist: package.json (updated), .vscodeignore (updated), README.md (new), CHANGELOG.md (new), images/icon.png (new)
2. `cd editors/vscode-mesh && npx vsce package --no-dependencies` produces a .vsix file without errors
3. The .vsix file size is reasonable (< 500KB, since it's just grammar + compiled JS + metadata)
4. `unzip -l *.vsix` shows no src/, tsconfig.json, node_modules/, or package-lock.json entries
</verification>

<success_criteria>
- EXT-03: Extension has icon, README with feature list, CHANGELOG.md
- EXT-04: Extension version bumped to 0.2.0
- EXT-05: .vscodeignore excludes dev files and prevents secret leakage
- `vsce package` produces a clean VSIX ready for publishing
</success_criteria>

<output>
After completion, create `.planning/phases/84-vscode-extension-publishing/84-01-SUMMARY.md`
</output>
